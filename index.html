<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Western Holiday Lighting | Boise–Meridian–Nampa Christmas Light Installation</title>
  <meta name="description" content="Premium, insured Christmas light installation across the Treasure Valley. Custom-cut C9 LEDs, pro design, safe install, takedown & optional storage." />
  <link rel="canonical" href="https://lightsidaho.com/" />

  <!-- security -->
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <meta name="referrer" content="strict-origin-when-cross-origin">

  <!-- social -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Western Holiday Lighting — Professional Christmas Light Installation">
  <meta property="og:description" content="Custom-fit C9 LEDs, pro design & safe installation. Serving Boise, Meridian, Nampa, Eagle, Kuna & Caldwell.">
  <meta property="og:url" content="https://lightsidaho.com/">
  <meta property="og:image" content="https://lightsidaho.com/uploads/logo.png">
  <meta name="twitter:card" content="summary_large_image">

  <!-- icons -->
  <link rel="icon" type="image/png" href="/uploads/logo.png">
  <link rel="apple-touch-icon" href="/uploads/logo.png">

  <!-- fonts + Netlify Identity -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <style>
    :root{
      --bg:#0b1220; --bg2:#0f1a33; --text:#e5f0ff; --muted:#98a6bd;
      --card:#0e162b; --accent:#22d3ee; --xmasRed:#ef4444; --xmasGreen:#22c55e; --gold:#facc15; --icy:#22d3ee;
      --logo-desktop: 240px; --logo-mobile-w: 70vw; --h1-max: 44px;
      --header-vignette-opacity:.58; --header-vignette-radius:60vw; --header-vignette-x:50%; --header-vignette-y:46%;
      --header-overlay-top:.35; --header-overlay-mid:.18; --header-overlay-end:0;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    a{color:var(--accent);text-decoration:none}
    .snow-bg{position:fixed; inset:0; z-index:0; pointer-events:none}
    .snow-top{position:absolute; inset:0; z-index:3; pointer-events:none}
    .light-rail{position:fixed; left:0; top:0; bottom:0; width:6px; z-index:2;
      background:
        radial-gradient(circle at 50% 6px, var(--xmasRed) 0 2px, transparent 2px),
        radial-gradient(circle at 50% 24px, var(--gold) 0 2px, transparent 2px),
        radial-gradient(circle at 50% 42px, var(--icy) 0 2px, transparent 2px),
        radial-gradient(circle at 50% 60px, var(--xmasGreen) 0 2px, transparent 2px),
        linear-gradient(#334155,#1f2937);
      background-size: 6px 72px, 6px 72px, 6px 72px, 6px 72px, 100% 100%;
      background-repeat: repeat-y;
      background-position: left top, left top, left top, left top, left top;
      box-shadow: inset 0 0 12px rgba(255,255,255,.05);
      pointer-events:none;
    }
    header{position:relative; z-index:1}
    .header{position:relative;background:#0a0f1c var(--header-bg, url('/uploads/banner.jpg')) center/cover no-repeat;border-bottom:1px solid rgba(255,255,255,.06)}
    .header::after{content:""; position:absolute; inset:0; z-index:1; pointer-events:none;
      background:linear-gradient(180deg,rgba(0,0,0,var(--header-overlay-top)),rgba(0,0,0,var(--header-overlay-mid)) 45%,rgba(0,0,0,var(--header-overlay-end)) 100%)}
    .header::before{content:""; position:absolute; inset:0; z-index:2; pointer-events:none;
      background:radial-gradient(circle var(--header-vignette-radius) at var(--header-vignette-x) var(--header-vignette-y),
        rgba(0,0,0, var(--header-vignette-opacity)) 0%,
        rgba(0,0,0, calc(var(--header-vignette-opacity)*.65)) 35%,
        rgba(0,0,0, calc(var(--header-vignette-opacity)*.35)) 60%,
        rgba(0,0,0, 0) 100%)}
    .container{max-width:1100px;margin:0 auto;padding:0 20px}
    .topbar{position:relative; z-index:4; padding:8px 0}
    .topnav{display:flex; gap:16px; align-items:center; justify-content:center; flex-wrap:wrap}
    .topnav a{color:#cfe0ff; opacity:.9; font-weight:600; font-size:.95rem}
    .topnav a:hover{opacity:1; text-decoration:underline}
    .nav{position:relative; z-index:4; display:flex; align-items:center; justify-content:space-between; padding:8px 0 2px}
    .logo-wrap{display:flex;align-items:center}
    .logo{height:var(--logo-desktop); width:auto; display:block; margin:-38px 0}
    .cta-row{display:flex;gap:12px;align-items:center}
    .btn{display:inline-block;padding:12px 18px;border-radius:12px;background:linear-gradient(135deg,var(--xmasRed),var(--xmasGreen));color:#052030;font-weight:800;letter-spacing:.3px;box-shadow:0 6px 18px rgba(239,68,68,.15),0 2px 8px rgba(34,197,94,.15)}
    .btn.outline{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,.15)}
    main{position:relative; z-index:1}
    .hero{display:grid;grid-template-columns:1.1fr .9fr;gap:28px;padding:22px 0 36px}
    @media (max-width:900px){.hero{grid-template-columns:1fr}}
    .badge{display:inline-block;font-size:.92rem;padding:6px 12px;margin:10px 0 14px 0;border-radius:999px;background:rgba(255,255,255,.08);
      border:1px solid transparent;border-image-slice:1;border-image-source:linear-gradient(90deg,var(--xmasRed),var(--gold),var(--icy),var(--xmasGreen));color:var(--text)}
    .hero h1{font-size:clamp(26px,3.2vw,var(--h1-max));line-height:1.08;margin:6px 0 10px}
    .hero p{color:var(--muted);font-size:1.02rem;margin-top:4px}
    .mobile-cta{display:none; gap:10px; margin:8px 0 6px}
    .mobile-cta .btn{width:100%; text-align:center}
    h2{font-size:clamp(22px,3vw,34px);margin:8px 0 6px; position:relative}
    h2::after{content:""; display:block; height:3px; margin-top:8px; border-radius:999px;
      background:linear-gradient(90deg,var(--xmasRed),var(--gold),var(--icy),var(--xmasGreen)); opacity:.55}
    .card{background:#0f162b;border:1px solid rgba(255,255,255,.08);border-radius:18px; padding:18px;position:relative; z-index:5;
      box-shadow:0 10px 28px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.04)}
    form{display:grid;gap:12px}
    input,select,textarea{width:100%;padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:#0b1426;color:var(--text)}
    .grid{display:grid;gap:16px}
    .grid.cols-3{grid-template-columns:repeat(3,1fr)}
    @media (max-width:900px){.grid.cols-3{grid-template-columns:1fr}}
    .section{padding:44px 0}
    .gallery{display:grid;grid-template-columns:repeat(6,1fr);gap:8px}
    @media (max-width:900px){.gallery{grid-template-columns:repeat(3,1fr)}}
    .gallery figure{aspect-ratio:1;border-radius:12px;background:#0d1b2a;border:1px dashed rgba(255,255,255,.1);display:flex;align-items:center;justify-content:center;color:#99a;margin:0;overflow:hidden}
    .gallery img{max-width:100%;max-height:100%;display:block}
    .bar{margin:20px 0;height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.18),transparent)}
    footer{padding:40px 0;color:#9db4d6;position:relative;z-index:1}
    @media (max-width:980px){.topnav{gap:12px}.topnav a{font-size:.9rem}}
    @media (max-width:780px){
      .logo{width:var(--logo-mobile-w);height:auto;margin:-62px 0}
      .nav{flex-direction:column;align-items:center;gap:8px;padding:6px 0}
      .logo-wrap{width:100%;justify-content:center}
      .nav .cta-row{display:none}
      .mobile-cta{display:flex; flex-direction:column;}
      :root{--header-vignette-opacity:.5;--header-vignette-radius:66vw;--header-vignette-y:44%}
    }
    @media (max-width:780px){
      .card .cta-row{display:flex; flex-direction:column; gap:10px}
      .card .cta-row .btn{width:100%; text-align:center}
    }
  </style>
</head>
<body>
  <div class="snow-bg" aria-hidden="true"><canvas id="snowBg" width="1" height="1"></canvas></div>
  <div class="light-rail" aria-hidden="true"></div>

  <header class="header">
    <div class="topbar">
      <div class="container">
        <nav class="topnav" aria-label="Primary">
          <a href="#gallery">Our Work</a>
          <a href="#packages">Packages</a>
          <a href="#faq">FAQ</a>
          <a href="#reviews">Reviews</a>
        </nav>
      </div>
    </div>

    <div class="snow-top" aria-hidden="true"><canvas id="snowTop" width="1" height="1"></canvas></div>

    <div class="container nav">
      <div class="logo-wrap">
        <img id="logo" class="logo" src="/uploads/logo.png" alt="Western Holiday Lighting logo">
      </div>
      <div class="cta-row">
        <a id="header_cta_label" class="btn outline" href="#quote">Get an Instant Estimate</a>
        <a id="header_cta_secondary" class="btn" href="tel:+12084093106">Call/Text (208) 409-3106</a>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <div>
        <div class="mobile-cta">
          <a id="m_header_cta_label" class="btn" href="#quote">Get an Instant Estimate</a>
          <a id="m_header_cta_secondary" class="btn outline" href="tel:+12084093106">Call/Text (208) 409-3106</a>
        </div>

        <span class="badge" id="areas">Boise • Meridian • Nampa • Kuna • Eagle • Caldwell</span>
        <h1 id="hero_headline">Pro Christmas Light Installation across Boise–Meridian–Nampa</h1>
        <p id="hero_subheadline" class="muted">Lease premium C9 LEDs on custom-cut lines for a perfect fit. Our full-service packages include design, installation, in-season maintenance, takedown, and optional storage.</p>
        <p><strong id="hero_offer">Book by Oct 15 &amp; save $100</strong></p>
      </div>

      <div class="card">
        <h2 id="quote">Instant Estimate</h2>
        <p class="muted">Text us your address and a photo of the front of your home for a fast quote, or use this form.</p>

        <!-- IMPORTANT: names here map to the JSON keys below -->
        <form name="quote" method="POST" data-netlify="true" action="/success/">
          <input type="hidden" name="form-name" value="quote" />
          <label>Full Name<input name="name" required autocomplete="name"></label>
          <label>Email (optional)<input name="email" type="email" autocomplete="email" placeholder="you@example.com"></label>
          <label>Mobile Number<input name="phone" type="tel" required autocomplete="tel"></label>
          <label>Address<input name="address" required placeholder="Street, City"></label>
          <label>Home Type
            <select name="stories">
              <option>Single-story</option>
              <option>Two-story</option>
              <option>Split level</option>
            </select>
          </label>
          <label>Extras
            <select name="extras">
              <option>None</option>
              <option>Wreath</option>
              <option>Tree wraps</option>
              <option>Walkway stakes</option>
            </select>
          </label>
          <label>Notes<textarea name="notes" rows="3" placeholder="Anything we should know? Gate code, steep roof, etc."></textarea></label>

          <div class="cta-row">
            <button class="btn" type="submit">Get My Estimate</button>
            <a class="btn outline" id="sms_link" href="sms:+12084093106?&body=Hi%20—%20my%20address%20is%20">Text Us Instead</a>
          </div>
          <p class="muted" style="font-size:.9rem">We'll send a ballpark quote using satellite & street views, then confirm on-site.</p>
        </form>
      </div>
    </section>

    <section id="packages" class="section">
      <h2>Simple Packages</h2>
      <p id="service_summary" class="muted">Transparent, competitive pricing for seasonal installs.</p>
      <div id="packages_wrap" class="grid cols-3"></div>
    </section>

    <section class="section" id="gallery">
      <h2>Recent Work</h2>
      <div id="gallery_grid" class="gallery"></div>
    </section>

    <section id="faq" class="section">
      <h2>FAQ</h2>
      <div id="faq_wrap" class="grid cols-3"></div>
    </section>

    <section id="reviews" class="section">
      <h2>What Neighbors Say</h2>
      <div id="testimonials" class="grid cols-3"></div>
    </section>
  </main>

  <footer>
    <div class="container">
      <div class="bar"></div>
      <div style="display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <div>© <span id="y"></span> <span id="business_name_footer">Western Holiday Lighting</span></div>
        <div id="footer_line" class="muted">Licensed & Insured • (208) 409-3106 • info@lightsidaho.com</div>
      </div>
    </div>
  </footer>

  <script>
    const $ = (id) => document.getElementById(id);
    const j = async (p) => { try { const r = await fetch(p); if (!r.ok) return null; return await r.json(); } catch(e){ return null; } };

    async function init(){
      const site  = await j('/content/site.json');
      const pkgs  = await j('/content/packages.json');
      const faq   = await j('/content/faq.json');
      const testi = await j('/content/testimonials.json');
      const gal   = await j('/content/gallery.json');

      if(site){
        $('business_name_footer').textContent = site.business_name || 'Western Holiday Lighting';
        if (site.logo) $('logo').setAttribute('src', site.logo);
        if (site.header_bg) document.querySelector('.header').style.setProperty('--header-bg', `url(${site.header_bg})`);
        ['hero_headline','hero_subheadline','hero_offer','service_summary','footer_line'].forEach(k=>{
          if(site[k]) document.getElementById(k).textContent = site[k];
        });
        if (Array.isArray(site.areas)) $('areas').textContent = site.areas.join(' • ');
        if (site.header_cta_label) {
          $('header_cta_label').textContent = site.header_cta_label;
          $('m_header_cta_label').textContent = site.header_cta_label;
        }
        if (site.phone_href){
          const tel = 'tel:'+site.phone_href;
          const sms = 'sms:'+site.phone_href+'?&body=Hi%20—%20my%20address%20is%20';
          $('header_cta_secondary').href = tel;
          $('m_header_cta_secondary').href = tel;
          $('sms_link').href = sms;
        }
        if (site.header_cta_secondary) {
          $('header_cta_secondary').textContent = site.header_cta_secondary;
          $('m_header_cta_secondary').textContent = site.header_cta_secondary;
        }
      }

      if(pkgs && Array.isArray(pkgs.packages)){
        const el = document.getElementById('packages_wrap');
        el.innerHTML = pkgs.packages.map(p => `
          <div class="card">
            <h3>${p.title||''}</h3>
            <div style="font-size:28px;font-weight:800">From $${p.price_from||''}</div>
            <div class="muted" style="font-size:.95rem">${p.blurb||''}</div>
            <ul style="margin:10px 0 0;padding-left:18px">${(p.includes||[]).map(i=>`<li>${i}</li>`).join('')}</ul>
            <div class="cta-row" style="margin-top:12px"><a class="btn" href="#quote">${p.cta||'Get Quote'}</a></div>
          </div>`).join('');
      }

      if(gal && Array.isArray(gal.images)){
        document.getElementById('gallery_grid').innerHTML = gal.images.map(it => `
          <figure title="${it.label||''}">
            ${it.image ? `<img src="${it.image}" alt="${it.label||'Gallery'}">` : it.label||'Image'}
          </figure>`).join('');
      }

      if(faq && Array.isArray(faq.faqs)){
        document.getElementById('faq_wrap').innerHTML = faq.faqs.map(q => `<div class="card"><h3>${q.q||''}</h3><p class="muted">${q.a||''}</p></div>`).join('');
      }

      if(testi && Array.isArray(testi.testimonials)){
        document.getElementById('testimonials').innerHTML = testi.testimonials.map(x => `<div class="card"><p>"${x.quote||''}"</p><p class="muted">— ${x.name||''}</p></div>`).join('');
      }

      $('y').textContent = new Date().getFullYear();
    }
    init();

    // ===== Snow animation (unchanged) =====
    function startSnow(canvas, opts){
      const ctx = canvas.getContext('2d');
      function size(){ canvas.width = innerWidth; canvas.height = opts.height || innerHeight; }
      size(); addEventListener('resize', size, {passive:true});

      let flakes = [];
      function add(n){
        for(let i=0;i<n;i++){
          flakes.push({
            x: Math.random()*canvas.width,
            y: -Math.random()*(opts.spawnBand || canvas.height*0.25) - 8,
            r: opts.rMin + Math.random()*(opts.rMax-opts.rMin),
            s: opts.speedMin + Math.random()*(opts.speedMax-opts.speedMin),
            drift: (Math.random()*0.6-0.3)
          });
        }
      }
      add(opts.initial || 60);
      const feeder = setInterval(()=>add(opts.trickle || 15), 800);
      setTimeout(()=>clearInterval(feeder), 3500);

      let t=0, raf;
      (function tick(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle = opts.color || "rgba(255,255,255,.9)";
        for(const f of flakes){
          f.y += f.s;
          f.x += Math.sin((t+f.y)/80)*0.35 + f.drift;
          if (f.y < canvas.height+8){
            ctx.beginPath(); ctx.arc(f.x,f.y,f.r,0,6.283); ctx.fill();
          }
        }
        flakes = flakes.filter(f=>f.y < canvas.height+8);
        t++; raf=requestAnimationFrame(tick);
      })();

      setTimeout(()=>{ canvas.style.transition="opacity .7s"; canvas.style.opacity="0"; }, 4700);
      setTimeout(()=>{ cancelAnimationFrame(raf); ctx.clearRect(0,0,canvas.width,canvas.height); }, 5600);
    }

    window.addEventListener('load', () => {
      const header = document.querySelector('.header');
      const cTop = document.getElementById('snowTop');
      const setTopSize = () => { cTop.width = innerWidth; cTop.height = header.getBoundingClientRect().height; };
      setTopSize(); addEventListener('resize', setTopSize, {passive:true});
      startSnow(cTop, { height: cTop.height, rMin:1, rMax:2.6, speedMin:.35, speedMax:1.0, initial:70, trickle:18 });

      const cBg = document.getElementById('snowBg');
      startSnow(cBg, { rMin:1, rMax:2.4, speedMin:.25, speedMax:.8, initial:60, trickle:15 });
    });

    // CMS invite redirect + login handoff (unchanged)
    if (location.hash && location.hash.startsWith('#/invite')) location.href = '/admin/' + location.hash;
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on('init', (user) => {
        if (!user) window.netlifyIdentity.on('login', () => { document.location.href = '/admin/'; });
      });
    }
  </script>

  <!-- === Zapier webhook submit === -->
  <script>
    const ZAPIER_WEBHOOK_URL = 'https://hooks.zapier.com/hooks/catch/XXXXXXXXX/XXXXXXXXX/'; // <- REPLACE

    // Prefer DOMContentLoaded so it works even if this script is above </body>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.querySelector('form[name="quote"]');
      if (!form) return;

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const fd = new FormData(form);
        const payload = {
          full_name:       fd.get('name')   || '',
          email:           fd.get('email')  || '',
          phone_number:    fd.get('phone')  || '',
          street_address:  fd.get('address')|| '',
          stories:         fd.get('stories')|| '',
          extras:          fd.get('extras') || '',
          notes:           fd.get('notes')  || '',
          source:         'Website Form',
          page_url:        window.location.href,
          submitted_at:    new Date().toISOString()
        };

        // Debug in console while testing
        console.log('Posting to Zapier:', payload);

        try {
          const resp = await fetch(ZAPIER_WEBHOOK_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });

          const text = await resp.text();
          console.log('Zapier response:', resp.status, text);

          alert("Thanks! We'll text you a fast estimate.");
          form.reset();

          // Fallback: if you want Netlify to also receive it for backup, uncomment next line
          // form.submit();
        } catch (err) {
          console.error('Zap post failed:', err);
          alert("Something went wrong. Please text us at (208) 409-3106.");
        }
      });
    });
  </script>
</body>
</html>
