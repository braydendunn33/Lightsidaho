<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Western Holiday Lighting | Boise–Meridian–Nampa Christmas Light Installation</title>
  <meta name="description" content="Premium, insured Christmas light installation across the Treasure Valley. Custom-cut C9 LEDs, pro design, maintenance, takedown & optional storage." />
  <link rel="canonical" href="https://lightsidaho.com/">

  <!-- Security & transport -->
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <meta name="referrer" content="strict-origin-when-cross-origin" />

  <!-- Social cards -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Western Holiday Lighting — Professional Christmas Light Installation" />
  <meta property="og:description" content="Custom-fit C9 LEDs, pro design & safe installation. Serving Boise, Meridian, Nampa, Eagle, Kuna & Caldwell." />
  <meta property="og:url" content="https://lightsidaho.com/" />
  <meta property="og:image" content="https://lightsidaho.com/uploads/logo.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Icons (also prevents browsers from probing /logo.png 404) -->
  <link rel="icon" type="image/png" href="/uploads/logo.png">
  <link rel="apple-touch-icon" href="/uploads/logo.png">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

  <!-- Netlify Identity (for /admin invite/login redirects) -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <style>
    :root{
      /* palette */
      --bg:#0b1220; --bg2:#0f1a33; --text:#e5f0ff; --muted:#9AA9C3;
      --accent:#22d3ee; --brand:#0ea5e9;
      --xmasRed:#ef4444; --xmasGreen:#22c55e;
      --card:#0e162b; /* opaque so snow never shows through */

      /* knobs */
      --container:1100px;
      --logo-desk-h: 380px;      /* desktop logo height (≈60% bigger from 240px) */
      --logo-trim-d: -46px;      /* trims transparent top/bottom on desktop */
      --logo-mobile-w: 72vw;     /* centered width on phones */
      --logo-trim-m: -58px;      /* trims on phones */
      --h1-max: 42px;
      --radius: 18px;
    }

    /* base */
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    a{color:var(--accent);text-decoration:none}

    .container{max-width:var(--container);margin:0 auto;padding:0 20px}

    /* HEADER (non-sticky) with optional background + snow in header only */
    header.header{
      position: relative;
      background: #0b1220; /* fallback if no image */
      background-image: var(--header-bg, none);
      background-size: cover; background-position:center; background-repeat:no-repeat;
      border-bottom:1px solid rgba(255,255,255,.06);
      isolation:isolate; /* local stacking for snow canvas layering */
    }
    .header-dim{position:absolute; inset:0; background:linear-gradient(180deg,rgba(0,0,0,.45),rgba(0,0,0,.35)); z-index:0}

    .nav{position:relative; z-index:2; display:flex; align-items:center; justify-content:space-between; padding:0}
    .logo-wrap{display:flex; align-items:center; gap:0}
    .logo{
      height:var(--logo-desk-h);
      width:auto; display:block;
      margin-block: var(--logo-trim-d);
    }

    .cta{display:flex; gap:12px; flex-wrap:wrap}
    .btn{
      display:inline-block; padding:12px 18px; border-radius:12px;
      background:linear-gradient(135deg,var(--xmasRed),var(--xmasGreen));
      color:#052030; font-weight:800; letter-spacing:.3px;
      box-shadow:0 6px 18px rgba(239,68,68,.15),0 2px 8px rgba(34,197,94,.15)
    }
    .btn.outline{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,.2)}

    /* MOBILE floating CTA (centered) */
    .mobile-cta{
      position:fixed; left:50%; bottom:14px; transform:translateX(-50%);
      z-index:50; display:none;
    }
    @media (max-width:780px){ .mobile-cta{ display:block } }

    /* HERO */
    main{position:relative; z-index:1}
    .hero{display:grid; grid-template-columns:1.1fr .9fr; gap:28px; padding:22px 0 36px}
    @media (max-width:900px){ .hero{ grid-template-columns:1fr } }

    .badge{
      display:inline-block; font-size:.92rem; padding:6px 12px; margin:8px 0 16px 0;
      border-radius:999px; background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12); color:var(--text)
    }
    h1{font-size:clamp(26px,3.3vw,var(--h1-max)); line-height:1.08; margin:6px 0 10px}
    .muted{color:var(--muted)}

    .card{
      background: var(--card);
      border:1px solid rgba(255,255,255,.08); border-radius:var(--radius); padding:18px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }

    form{display:grid; gap:12px}
    label{font-weight:600; font-size:.95rem}
    input,select,textarea{
      width:100%; padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.12);
      background:#0b1426; color:var(--text)
    }
    .disclaimer{font-size:.85rem; color:#A7B5CC}

    /* Sections */
    .section{padding:44px 0}
    .grid{display:grid; gap:16px}
    .cols-3{grid-template-columns:repeat(3,1fr)}
    @media (max-width:900px){ .cols-3{ grid-template-columns:1fr } }
    h2{font-size:clamp(22px,3vw,34px); margin:8px 0 6px}
    .price{font-weight:800; font-size:28px}
    .list{margin:10px 0 0; padding-left:18px}

    .bar{margin:20px 0; height:1px; background:linear-gradient(90deg,transparent,rgba(255,255,255,.18),transparent)}
    footer{padding:40px 0; color:#9db4d6}

    /* Header snow canvas (only in header, fades out) */
    #snow{position:absolute; inset:0; z-index:1; pointer-events:none; opacity:0; transition:opacity .4s ease}

    /* Responsive logo + layout */
    @media (max-width:1100px){ .logo{ height:320px; margin-block:-26px } }
    @media (max-width:780px){
      .nav{ flex-direction:column; align-items:center; gap:6px; padding:2px 0 }
      .logo-wrap{ width:100%; justify-content:center }
      .logo{ width:var(--logo-mobile-w); height:auto; margin-block: var(--logo-trim-m) }
    }
  </style>
</head>
<body>

  <!-- MOBILE floating CTA -->
  <a class="mobile-cta btn" href="#quote" aria-label="Get an instant estimate">Get an Instant Estimate</a>

  <!-- HEADER (non-sticky) -->
  <header class="header" id="top">
    <canvas id="snow" aria-hidden="true"></canvas>
    <div class="header-dim" aria-hidden="true"></div>

    <div class="container nav">
      <div class="logo-wrap">
        <img id="logo" class="logo" src="/uploads/logo.png" alt="Western Holiday Lighting logo" width="800" height="300" loading="eager" fetchpriority="high">
      </div>
      <div class="cta" aria-label="Contact actions">
        <a id="header_cta_label" class="btn outline" href="#quote">Get an Instant Estimate</a>
        <a id="header_cta_secondary" class="btn" href="tel:+12084093106">Call/Text (208) 409-3106</a>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="hero" aria-labelledby="hero_headline">
      <div>
        <span class="badge" id="areas">Boise • Meridian • Nampa • Kuna • Eagle • Caldwell</span>
        <h1 id="hero_headline">Pro Christmas Light Installation across Boise–Meridian–Nampa</h1>
        <p id="hero_subheadline" class="muted">
          Lease premium C9 LEDs on custom-cut lines for a perfect fit. Our full-service packages include design, installation,
          in-season maintenance, takedown, and optional storage.
        </p>
        <p><strong id="hero_offer">Book by Oct 15 &amp; save $100</strong></p>
      </div>

      <aside class="card" aria-labelledby="quote">
        <h2 id="quote">Instant Estimate</h2>
        <p class="muted">Text us your address and a photo of the front of your home for a fast quote, or use this form.</p>

        <form name="quote" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" action="/success/">
          <input type="hidden" name="form-name" value="quote" />
          <p hidden aria-hidden="true">
            <label>Don’t fill this out if you’re human: <input name="bot-field" /></label>
          </p>

          <label for="name">Full Name</label>
          <input id="name" name="name" autocomplete="name" required>

          <label for="phone">Mobile Number</label>
          <input id="phone" name="phone" inputmode="tel" autocomplete="tel" required>

          <label for="address">Address</label>
          <input id="address" name="address" placeholder="Street, City" autocomplete="street-address" required>

          <label for="stories">Home Type</label>
          <select id="stories" name="stories">
            <option>Single-story</option><option>Two-story</option><option>Split level</option>
          </select>

          <label for="extras">Extras</label>
          <select id="extras" name="extras">
            <option>None</option><option>Wreath</option><option>Tree wraps</option><option>Walkway stakes</option>
          </select>

          <label for="notes">Notes</label>
          <textarea id="notes" name="notes" rows="3" placeholder="Gate code, steep roof, pets, etc."></textarea>

          <div class="cta">
            <button class="btn" type="submit">Get My Estimate</button>
            <a class="btn outline" id="sms_link" href="sms:+12084093106?&body=Hi%20—%20my%20address%20is%20">Text Us Instead</a>
          </div>
          <p class="disclaimer">We’ll send a ballpark quote using satellite &amp; street views, then confirm on-site.</p>
        </form>
      </aside>
    </section>

    <section id="packages" class="section" aria-labelledby="packages_h">
      <h2 id="packages_h">Simple Packages</h2>
      <p id="service_summary" class="muted">Transparent, competitive pricing for seasonal installs.</p>
      <div id="packages_wrap" class="grid cols-3"></div>
    </section>

    <section class="section" aria-labelledby="work_h">
      <h2 id="work_h">Recent Work</h2>
      <div id="gallery" class="grid cols-3" aria-live="polite"></div>
    </section>

    <section id="faq" class="section" aria-labelledby="faq_h">
      <h2 id="faq_h">FAQ</h2>
      <div id="faq_wrap" class="grid cols-3"></div>
    </section>

    <section class="section" aria-labelledby="testi_h">
      <h2 id="testi_h">What Neighbors Say</h2>
      <div id="testimonials" class="grid cols-3"></div>
    </section>
  </main>

  <footer>
    <div class="container">
      <div class="bar" role="presentation"></div>
      <div style="display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <div>© <span id="y"></span> <span id="business_name_footer">Western Holiday Lighting</span></div>
        <div id="footer_line" class="muted">Licensed &amp; Insured • (208) 409-3106 • info@lightsidaho.com</div>
      </div>
    </div>
  </footer>

  <script>
    // --- tiny helpers ---
    const $ = (id) => document.getElementById(id);
    const j = async (p) => { try { const r = await fetch(p); return r.ok ? r.json() : null; } catch(_) { return null; } };
    const setText = (el, val) => el && val != null && (el.textContent = val);
    const setAttr = (el, n, v) => el && v && el.setAttribute(n, v);

    // --- CMS-driven content ---
    (async function init(){
      const site  = await j('/content/site.json');
      const pkgs  = await j('/content/packages.json');
      const faq   = await j('/content/faq.json');
      const testi = await j('/content/testimonials.json');
      const gal   = await j('/content/gallery.json');

      if (site){
        // Brand assets
        setAttr($('logo'), 'src', site.logo || '/uploads/logo.png');
        const header = document.querySelector('header.header');
        if (site.header_bg) header.style.setProperty('--header-bg', `url(${site.header_bg})`);

        // Copy
        setText($('business_name_footer'), site.business_name);
        setText($('hero_headline'), site.hero_headline);
        setText($('hero_subheadline'), site.hero_subheadline);
        setText($('hero_offer'), site.hero_offer);
        setText($('service_summary'), site.service_summary);
        setText($('footer_line'), site.footer_line);
        setText($('areas'), (site.areas || []).join(' • '));
        setText($('header_cta_label'), site.header_cta_label);

        // Phone/SMS
        if (site.phone_href){
          const tel = 'tel:' + site.phone_href;
          const sms = 'sms:' + site.phone_href + '?&body=Hi%20—%20my%20address%20is%20';
          $('header_cta_secondary')?.setAttribute('href', tel);
          $('sms_link')?.setAttribute('href', sms);
        }
        if (site.header_cta_secondary){
          $('header_cta_secondary').textContent = site.header_cta_secondary;
        }

        // JSON-LD (inject after we have CMS values)
        const ld = {
          "@context":"https://schema.org",
          "@type":"HomeAndConstructionBusiness",
          "name": site.business_name || "Western Holiday Lighting",
          "image": site.logo || "https://lightsidaho.com/uploads/logo.png",
          "url":"https://lightsidaho.com/",
          "telephone": site.phone_href ? `+1${site.phone_href}` : "+12084093106",
          "address":{
            "@type":"PostalAddress",
            "streetAddress": site.address_line || "",
            "addressLocality": (site.city_region_zip||"").split(",")[0]?.trim() || "Boise",
            "addressRegion": "ID",
            "postalCode": (site.city_region_zip||"").match(/\b\d{5}\b/)?.[0] || ""
          },
          "areaServed": (site.areas||[]),
          "sameAs": []
        };
        const s = document.createElement('script');
        s.type = 'application/ld+json';
        s.textContent = JSON.stringify(ld);
        document.head.appendChild(s);
      }

      if (pkgs?.packages?.length){
        $('packages_wrap').innerHTML = pkgs.packages.map(p => `
          <article class="card" itemscope itemtype="https://schema.org/Offer">
            <h3 itemprop="name">${p.title||''}</h3>
            <div class="price">From $<span itemprop="price">${p.price_from||''}</span></div>
            <meta itemprop="priceCurrency" content="USD" />
            <p class="muted">${p.blurb||''}</p>
            <ul class="list">${(p.includes||[]).map(i=>`<li>${i}</li>`).join('')}</ul>
            <div class="cta"><a class="btn" href="#quote">${p.cta||'Get Quote'}</a></div>
          </article>`).join('');
      }

      if (faq?.faqs?.length){
        $('faq_wrap').innerHTML = faq.faqs.map(q => `
          <article class="card">
            <h3>${q.q||''}</h3>
            <p class="muted">${q.a||''}</p>
          </article>`).join('');
      }

      if (testi?.testimonials?.length){
        $('testimonials').innerHTML = testi.testimonials.map(x => `
          <blockquote class="card" itemprop="review" itemscope itemtype="https://schema.org/Review">
            <p itemprop="reviewBody">“${x.quote||''}”</p>
            <p class="muted">— <span itemprop="author">${x.name||''}</span></p>
          </blockquote>`).join('');
      }

      if (gal?.images?.length){
        $('gallery').innerHTML = gal.images.map(it => `
          <figure class="card" style="padding:0; overflow:hidden">
            ${it.image ? `<img loading="lazy" src="${it.image}" alt="${it.label||'Holiday lights'}" style="display:block;width:100%;height:auto">` : `<div class="muted" style="padding:24px">${it.label||'Image'}</div>`}
          </figure>`).join('');
      }

      $('y').textContent = new Date().getFullYear();
    })();

    // Header-only snow (never over content). Respects prefers-reduced-motion. Fades out by ~10s then stops.
    (function snow(){
      const canvas = $('snow');
      if (!canvas) return;
      const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (reduce) return;

      const ctx = canvas.getContext('2d');
      let W, H, flakes=[], anim, start=performance.now();

      function size(){ W = canvas.width = canvas.offsetWidth; H = canvas.height = canvas.offsetHeight; }
      const onResize = () => { size(); };
      new ResizeObserver(onResize).observe(canvas); size();

      const N = Math.min(120, Math.floor(W/8));
      for (let i=0;i<N;i++){
        flakes.push({
          x: Math.random()*W,
          y: Math.random()*H,
          r: 0.8 + Math.random()*2.2,
          s: 0.4 + Math.random()*1.1,    // speed
          a: Math.random()*Math.PI*2,     // angle
          w: 0.3 + Math.random()*0.9      // sway
        });
      }

      canvas.style.opacity = '1';

      function tick(t){
        const elapsed = (t - start)/1000; // seconds
        ctx.clearRect(0,0,W,H);
        ctx.fillStyle = 'rgba(255,255,255,0.9)';
        for (const f of flakes){
          f.y += f.s;
          f.x += Math.sin(f.a += 0.01)*f.w;
          if (f.y > H) { f.y = -6; f.x = Math.random()*W; }
          ctx.beginPath(); ctx.arc(f.x, f.y, f.r, 0, Math.PI*2); ctx.fill();
        }
        if (elapsed < 10){ anim = requestAnimationFrame(tick); } // run ~10s
        else {
          // fade out gracefully then stop
          canvas.style.opacity = '0';
          setTimeout(()=>{ cancelAnimationFrame(anim); ctx.clearRect(0,0,W,H); }, 500);
        }
      }
      anim = requestAnimationFrame(tick);
    })();

    // Identity invite → /admin, and post-login → /admin
    if (location.hash && location.hash.startsWith('#/invite')) {
      location.href = '/admin/' + location.hash;
    }
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on('init', (user) => {
        if (!user) window.netlifyIdentity.on('login', () => { location.href = '/admin/'; });
      });
    }
  </script>
</body>
</html>
